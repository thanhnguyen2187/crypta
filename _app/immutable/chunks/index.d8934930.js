import{r as f,a7 as x,J as z,s as A,M as E}from"./scheduler.2ab39a2c.js";const a=[];function y(t,u){return{subscribe:m(t,u).subscribe}}function m(t,u=f){let e;const r=new Set;function c(s){if(A(t,s)&&(t=s,e)){const o=!a.length;for(const n of r)n[1](),a.push(n,t);if(o){for(let n=0;n<a.length;n+=2)a[n][0](a[n+1]);a.length=0}}}function l(s){c(s(t))}function d(s,o=f){const n=[s,o];return r.add(n),r.size===1&&(e=u(c,l)||f),s(t),()=>{r.delete(n),r.size===0&&e&&(e(),e=null)}}return{set:c,update:l,subscribe:d}}function q(t,u,e){const r=!Array.isArray(t),c=r?[t]:t;if(!c.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=u.length<2;return y(e,(d,s)=>{let o=!1;const n=[];let p=0,h=f;const w=()=>{if(p)return;h();const i=u(r?n[0]:n,d,s);l?d(i):h=E(i)?i:f},g=c.map((i,b)=>x(i,v=>{n[b]=v,p&=~(1<<b),o&&w()},()=>{p|=1<<b}));return o=!0,w(),function(){z(g),h(),o=!1}})}export{q as d,y as r,m as w};
